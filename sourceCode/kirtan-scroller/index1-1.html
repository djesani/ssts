<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Kirtans</title>
</head>

<body>
    <h1 id="title"></h1>
    <ul id="list" class="list">
        <li id="l0">Line 0</li>
        <li id="l1">Line 1</li>
        <li id="l2">Line 2</li>
        <li id="l3">Line 3</li>
        <li id="l4">Line 4</li>
    </ul>
</body>

<script>
    // Add event listener on keydown
    document.addEventListener('keydown', (event) => {
        if (event.keyCode == 38) {
            //Up Arrow Pushed
            if (index > 0) {
                prev();
            }
        } else if (event.keyCode == 40) {
            //Down Arrow Pushed
            console.log("slides.length", slides.length)
            if ((index + 3) < slides.length) {
                next();
            }
        }
        console.log("index", index);
        // console.log("slides addEventListener index", slides[index]);
    }, false);
</script>

<script>
    let kirtanJson;
    var slides;
    let title;
    let list = "";
    let index;
    async function loadData() {
        const response = await fetch("data.json");
        kirtanJson = await response.json();
        id = getUrlParamsId();
        kirtan = getKirtanById(id);
        title = kirtan.title_english;
        description = kirtan.description_english;
        slides = description.split("\n");
        renderTitle();
        renderSlides();
    }

    function renderTitle() {
        titleElement = document.getElementById('title');
        titleElement.innerHTML = title;
    }

    function getKirtanById(id) {
        kirtan = kirtanJson.data.find(x => x.id == id);
        if (kirtan) {
            return kirtan;
        } else {
            return kirtanJson.data.find(x => x.id == 1);
        }
    }

    function getUrlParamsId() {
        urlSearch = window.location.search;
        if (urlSearch) {
            urlParams = new URLSearchParams(urlSearch);
            id = urlParams.get('id')
        } else {
            id = 1
        }
        return id;
    }

    loadData();
</script>

<script>
    index = 0;
    list = document.getElementById('list');
    l0 = document.getElementById('l0');
    l1 = document.getElementById('l1');
    l2 = document.getElementById('l2');
    l3 = document.getElementById('l3');
    l4 = document.getElementById('l4');

    function renderSlides() {
        l0.innerHTML = slides[index - 1];
        l1.innerHTML = slides[index + 0];
        l2.innerHTML = slides[index + 1];
        l3.innerHTML = slides[index + 2];
        l4.innerHTML = slides[index + 3];
    }

    function prev() {
        l0.classList.remove("no-animation");
        l1.classList.remove("no-animation");
        l2.classList.remove("no-animation");
        l3.classList.remove("no-animation");
        l4.classList.remove("no-animation");

        list.classList.remove("grow");
        list.classList.add("shrink");
        setTimeout(() => {
            l0.classList.add("no-animation");
            l1.classList.add("no-animation");
            l2.classList.add("no-animation");
            l3.classList.add("no-animation");
            l4.classList.add("no-animation");

            list.classList.remove("shrink");
            index = index - 1;
            renderSlides();
        }, 500)
    }
    function next() {
        l0.classList.remove("no-animation");
        l1.classList.remove("no-animation");
        l2.classList.remove("no-animation");
        l3.classList.remove("no-animation");
        l4.classList.remove("no-animation");

        list.classList.add("grow");
        list.classList.remove("shrink");
        setTimeout(() => {
            l0.classList.add("no-animation");
            l1.classList.add("no-animation");
            l2.classList.add("no-animation");
            l3.classList.add("no-animation");
            l4.classList.add("no-animation");

            list.classList.remove("grow");
            index = index + 1;
            renderSlides();
        }, 500)
    }
</script>

<style>
    body {
        background-color: #fff2e6;
        color: #990101;
        overflow: hidden;
    }

    :root {
        --default-color: #990101;
        --default-opacity: 1;
        --default-font-weight: normal;
        --highlight-color: #ff6a00;
        /* --highlight-color: red; */
        --highlight-font-size: 40px;
        --highlight-font-weight: normal;
        --highlight-font-weight: bold;
        --transition-duration: 500ms;
        --no-of-lines: 5;
    }

    #title {
        font-size: 40px;
        text-align: center;
    }

    ul {
        list-style: none;
        padding: 0;
    }

    li {
        padding: 5px 0;
        font-size: 30px;
        width: 100%;
        text-align: center;
        color: var(--default-color);
        font-weight: normal;
        transition-property: all;
        transition-timing-function: linear;
        transition-duration: var(--transition-duration);
        position: absolute;
    }

    li.no-animation {
        transition: none;
    }
</style>

<style>
    #l0 {
        top: 10vh;
        opacity: 0;
        color: var(--default-color);
    }

    #l1 {
        top: 30vh;
        top: calc(calc ((100vh / 5) + 10));
        color: var(--default-color);
        opacity: var(--default-opacity);
        --highlight-font-weight: bold;
    }

    #l2 {
        top: 50vh;
        font-size: var(--highlight-font-size);
        font-weight: var(--highlight-font-weight);
        color: var(--highlight-color);
    }

    #l3 {
        top: 70vh;
        color: var(--default-color);
        opacity: var(--default-opacity);
    }

    #l4 {
        top: 90vh;
        opacity: 0;
        color: var(--default-color);
    }

    .list.grow #l0 {
        top: 0vh;
        opacity: 0;
        color: var(--default-color);
    }

    .list.grow #l1 {
        top: 10vh;
        opacity: 0;
        font-weight: var(--default-font-weight);
    }

    .list.grow #l2 {
        top: 30vh;
        font-size: 30px;
        opacity: var(--default-opacity);
        color: var(--default-color);
        font-weight: var(--default-font-weight);
    }

    .list.grow #l3 {
        top: 50vh;
        font-size: var(--highlight-font-size);
        font-weight: var(--highlight-font-weight);
        color: var(--highlight-color);
        opacity: 1;
    }

    .list.grow #l4 {
        top: 70vh;
        opacity: var(--default-opacity);
        color: var(--default-color);
    }

    .list.shrink #l0 {
        top: 30vh;
        opacity: var(--default-opacity);
        color: var(--default-color);
    }

    .list.shrink #l1 {
        top: 50vh;
        font-size: var(--highlight-font-size);
        font-weight: var(--default-font-weight);
        color: var(--highlight-color);
        opacity: 1;
    }

    .list.shrink #l2 {
        top: 70vh;
        font-size: 30px;
        opacity: var(--default-opacity);
        color: var(--default-color);
        font-weight: var(--default-font-weight);
    }

    .list.shrink #l3 {
        top: 90vh;
        opacity: 0;
        color: var(--default-color);
    }

    .list.shrink #l4 {
        top: 100vh;
        opacity: 0;
        color: var(--default-color);
    }
</style>

</html>