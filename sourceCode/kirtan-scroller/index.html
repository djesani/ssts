<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Kirtans</title>
</head>

<body>
    <h1 id="title"></h1>
    <ul id="list" class="list">
        <li id="l0">Line 0</li>
        <li id="l1">Line 1</li>
        <li id="l2">Line 2</li>
        <li id="l3">Line 3</li>
        <li id="l4">Line 4</li>
    </ul>
</body>

<script>
    // Add event listener on keydown
    document.addEventListener('keydown', (event) => {
        if (event.keyCode == 38) {
            //Up Arrow Pushed
            if (index > 3) {
                prev();
            }
        } else if (event.keyCode == 40) {
            //Down Arrow Pushed
            console.log("slides.length", slides.length)
            if ((index + 6) < slides.length) {
                next();
            }
        }
        console.log("index", index);
        // console.log("slides addEventListener index", slides[index]);
    }, false);
</script>

<script>
    let kirtanJson;
    var slides;
    let title;
    let list = "";
    let index;
    async function loadData() {
        const response = await fetch("data.json");
        kirtanJson = await response.json();
        id = getUrlParamsId();
        kirtan = getKirtanById(id);
        title = kirtan.title_english;
        description = kirtan.description_english;
        slides = description.split("\n");
        renderTitle();
        renderSlides();
    }

    function renderTitle() {
        titleElement = document.getElementById('title');
        titleElement.innerHTML = title;
    }

    function getKirtanById(id) {
        kirtan = kirtanJson.data.find(x => x.id == id);
        if (kirtan) {
            return kirtan;
        } else {
            return kirtanJson.data.find(x => x.id == 1);
        }
    }

    function getUrlParamsId() {
        urlSearch = window.location.search;
        if (urlSearch) {
            urlParams = new URLSearchParams(urlSearch);
            id = urlParams.get('id')
        } else {
            id = 1
        }
        return id;
    }

    loadData();
</script>

<script>
    index = 0;
    list = document.getElementById('list');
    l0 = document.getElementById('l0');
    l1 = document.getElementById('l1');
    l2 = document.getElementById('l2');
    l3 = document.getElementById('l3');
    l4 = document.getElementById('l4');

    function renderSlides() {
        l0.innerHTML = slides[index - 1];
        l1.innerHTML = slides[index + 0];
        l2.innerHTML = slides[index + 1];
        l3.innerHTML = slides[index + 2];
        l4.innerHTML = slides[index + 3];
    }

    function prev() {
        l0.classList.remove("no-animation");
        l1.classList.remove("no-animation");
        l2.classList.remove("no-animation");
        l3.classList.remove("no-animation");
        l4.classList.remove("no-animation");

        list.classList.remove("grow");
        list.classList.add("shrink");
        setTimeout(() => {
            l0.classList.add("no-animation");
            l1.classList.add("no-animation");
            l2.classList.add("no-animation");
            l3.classList.add("no-animation");
            l4.classList.add("no-animation");

            list.classList.remove("shrink");
            index = index - 1;
            renderSlides();
        }, 600)
    }
    function next() {
        l0.classList.remove("no-animation");
        l1.classList.remove("no-animation");
        l2.classList.remove("no-animation");
        l3.classList.remove("no-animation");
        l4.classList.remove("no-animation");

        list.classList.add("grow");
        list.classList.remove("shrink");
        setTimeout(() => {
            l0.classList.add("no-animation");
            l1.classList.add("no-animation");
            l2.classList.add("no-animation");
            l3.classList.add("no-animation");
            l4.classList.add("no-animation");

            list.classList.remove("grow");
            index = index + 1;
            renderSlides();
        }, 600)
    }
</script>

<style>
    /* The animation code */
    /* @keyframes MoveUpDown {

        0%,
        100% {
            transform: translateY(0);
        }

        50% {
            transform: translateY(-100px);
        }
    } */


    ul {
        list-style: none;
        padding: 0;
    }

    li {
        padding: 5px 0;
        font-size: 40px;
        width: 100%;
        transition: all .5s ease-in-out;
        text-align: center;
    }

    #title {
        font-size: 50px;
        text-align: center;
    }

    li.no-animation {
        transition: none !important;
        /* animation: MoveUpDown 1s ease-in-out infinite ; */
    }
</style>

<style>
    #l0 {
        position: absolute;
        top: 100px;
        font-size:20px;
        opacity: 0;
    }

    #l1 {
        position: absolute;
        top: 200px;
        font-size: 30px;
    }

    #l2 {
        position: absolute;
        top: 300px;
        font-size: 40px;
    }

    #l3 {
        position: absolute;
        top: 400px;
        font-size: 30px;
    }

    #l4 {
        position: absolute;
        top: 500px;
        font-size: 20px;
        opacity: 0;
    }

    .list.grow #l0 {
        top: 0px;
        font-size: 10px;
        opacity: 0;
    }

    .list.grow #l1 {
        top: 100px;
        font-size: 20px;
        opacity: 0;
    }

    .list.grow #l2 {
        top: 200px;
        font-size: 30px;
        opacity: 1;
    }

    .list.grow #l3 {
        top: 300px;
        font-size: 40px;
        opacity: 1;
    }

    .list.grow #l4 {
        top: 400px;
        font-size: 30px;
        opacity: 1;
    }

    .list.shrink #l0 {
        top: 200px;
        font-size: 30px;
        opacity: 1;
    }

    .list.shrink #l1 {
        top: 300px;
        font-size: 40px;
        opacity: 1;
    }

    .list.shrink #l2 {
        top: 400px;
        font-size: 30px;
        opacity: 1;
    }

    .list.shrink #l3 {
        top: 500px;
        font-size: 20px;
        opacity: 0;
    }

    .list.shrink #l4 {
        top: 600px;
        font-size: 10px;
        opacity: 0;
    }
</style>

</html>