"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([["src_app_events_events_module_ts"],{1693:(z,f,r)=>{r.r(f),r.d(f,{EventsModule:()=>$});var u=r(9808),_=r(520),a=r(3075),E=r(9664),c=r(2626),e=r(4893),g=r(2340);const v=`${g.N.CONTEXT_PATH}/events`;let p=(()=>{class n{constructor(t){this.http=t}getAll(){return this.http.get(v)}get(t){return this.http.get(`${v}/${t}`)}add(t){return this.http.post(v,t)}update(t,i){return this.http.patch(`${v}/${t}`,i)}delete(t){return this.http.delete(`${v}/${t}`)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(_.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var A=r(9444);let x=(()=>{class n{transform(t,i,s){return s?(t||[]).filter(l=>i.split(",").some(h=>l.hasOwnProperty(h)&&new RegExp(s,"gi").test(l[h]))):t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=e.Yjl({name:"search",type:n,pure:!0}),n})();const b=function(){return["fas","check-circle"]};function y(n,o){1&n&&(e.TgZ(0,"span",24),e._UZ(1,"fa-icon",11),e.qZA()),2&n&&(e.xp6(1),e.Q6J("icon",e.DdM(1,b)))}const D=function(){return["fas","times-circle"]};function F(n,o){1&n&&(e.TgZ(0,"span",25),e._UZ(1,"fa-icon",11),e.qZA()),2&n&&(e.xp6(1),e.Q6J("icon",e.DdM(1,D)))}function C(n,o){if(1&n&&(e.TgZ(0,"div",18)(1,"div",14)(2,"div",19),e._uU(3),e.qZA()(),e.TgZ(4,"div",15)(5,"div",19),e._uU(6),e.qZA()(),e.TgZ(7,"div",16)(8,"div",19),e._uU(9),e.qZA()(),e.TgZ(10,"div",20),e.YNc(11,y,2,2,"span",21),e.YNc(12,F,2,2,"span",22),e.qZA(),e.TgZ(13,"div",16)(14,"button",23),e._uU(15,"Edit"),e.qZA()()()),2&n){const t=o.$implicit;e.xp6(3),e.Oqu(t.name),e.xp6(3),e.Oqu(t.description),e.xp6(3),e.Oqu(t.startDate),e.xp6(2),e.Q6J("ngIf",!t.unpublished),e.xp6(1),e.Q6J("ngIf",t.unpublished),e.xp6(2),e.MGl("routerLink","edit/",t.filename,"")}}const I=function(){return["fas","search"]};function S(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",2)(1,"div",3)(2,"header",4)(3,"div",5)(4,"div",6)(5,"button",7),e._uU(6,"Add"),e.qZA()(),e.TgZ(7,"div",8)(8,"div",9)(9,"input",10),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw().query=s}),e.qZA(),e._UZ(10,"fa-icon",11),e.qZA()()()()(),e.TgZ(11,"div",12)(12,"div",13)(13,"div",14),e._uU(14," Name "),e.qZA(),e.TgZ(15,"div",15),e._uU(16," Description "),e.qZA(),e.TgZ(17,"div",16),e._uU(18," Start date "),e.qZA(),e.TgZ(19,"div",16),e._uU(20," Published "),e.qZA(),e._UZ(21,"div",16),e.qZA(),e.YNc(22,C,16,6,"div",17),e.ALo(23,"search"),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(9),e.Q6J("ngModel",t.query),e.xp6(1),e.Q6J("icon",e.DdM(7,I)),e.xp6(12),e.Q6J("ngForOf",e.Dn7(23,3,t.events,"name",t.query))}}let q=(()=>{class n{constructor(t){this.eventsService=t}ngOnInit(){this.eventsService.getAll().subscribe(t=>{this.events=t}),this.isSideMenuShow()}isSideMenuShow(){"true"==localStorage.getItem("isSideMenuShow")&&(document.getElementById("header-nav").style.marginLeft="250px",document.getElementById("side-nav").style.width="250px",document.getElementById("main-content").style.marginLeft="250px")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-events-list"]],decls:2,vars:1,consts:[["id","main-content"],["class","events",4,"ngIf"],[1,"events"],[1,"header-nav"],["id","header-nav"],[1,"row","add-wrapper"],[1,"col-sm-1","btn-add-container"],["routerLink","add",1,"btn","btn-primary","btn-add"],[1,"col-sm-11"],[1,"header-search-wrapper"],["placeholder","search . . .",1,"header-search-input",3,"ngModel","ngModelChange"],[3,"icon"],[1,"events-list"],[1,"row","row-event-header"],[1,"col-2"],[1,"col-7"],[1,"col-1"],["class","row row-event",4,"ngFor","ngForOf"],[1,"row","row-event"],[1,"event-name"],[1,"col-1","read-only","published-status"],["class","published",4,"ngIf"],["class","unpublished",4,"ngIf"],[1,"btn","btn-primary",3,"routerLink"],[1,"published"],[1,"unpublished"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,S,24,8,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.events))},directives:[u.O5,c.rH,a.Fj,a.JJ,a.On,A.BN,u.sg],pipes:[x],encapsulation:2}),n})();function U(n,o){if(1&n&&(e.TgZ(0,"div",8),e._UZ(1,"img",9),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.s9C("src",t.event.imageurl,e.LSH)}}function M(n,o){if(1&n&&(e.TgZ(0,"div",2),e.YNc(1,U,2,1,"div",3),e.TgZ(2,"div",4)(3,"div")(4,"div",5)(5,"div"),e._uU(6),e.qZA()(),e.TgZ(7,"div",6)(8,"div"),e._uU(9),e.qZA()()(),e.TgZ(10,"div",7),e._uU(11),e.qZA()()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.event.imageurl),e.xp6(5),e.Oqu(t.event.name),e.xp6(3),e.Oqu(t.event.startDate),e.xp6(2),e.Oqu(t.event.description)}}let N=(()=>{class n{constructor(t,i){this.eventsService=t,this.activatedRoute=i,this.getId=this.activatedRoute.snapshot.paramMap.get("id")}ngOnInit(){this.eventsService.getAll().subscribe(t=>{this.events=t,this.event=this.events.find(i=>i.name=this.getId)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p),e.Y36(c.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-events-detail"]],decls:2,vars:1,consts:[["id","main-content"],["class","detail",4,"ngIf"],[1,"detail"],["class","thumb",4,"ngIf"],[1,"events-text"],[1,"name"],[1,"startDate"],[1,"description"],[1,"thumb"],[1,"thumb-img",3,"src"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,M,12,4,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.events))},directives:[u.O5],encapsulation:2}),n})();var Z=r(6913),L=r(8441);let w=(()=>{class n{constructor(t,i){this.el=t,this.formGroupDir=i}onSubmit(){this.formGroupDir.control.invalid&&this.scrollToFirstInvalidControl()}scrollToFirstInvalidControl(){const t=this.el.nativeElement.querySelector(".ng-invalid");scroll({top:this.getTopOffset(t),behavior:"smooth"}),t.focus()}getTopOffset(t){return t.getBoundingClientRect().top+window.scrollY-35}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq),e.Y36(a.sg))},n.\u0275dir=e.lG2({type:n,selectors:[["","ScrollToInvalidControl",""]],hostBindings:function(t,i){1&t&&e.NdJ("ngSubmit",function(){return i.onSubmit()})}}),n})();var J=r(3825);const O=["name"];function Y(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1,"Edit "),e.qZA())}function k(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1,"Add "),e.qZA())}function Q(n,o){if(1&n&&e._UZ(0,"img",33),2&n){const t=e.oxw(2);e.hYB("src","",t.LOCAL_PATH,"",t.event.imageurl,"",e.LSH)}}function B(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",2)(1,"h5",3),e.YNc(2,Y,2,0,"span",4),e.YNc(3,k,2,0,"span",4),e.TgZ(4,"span",5),e._uU(5,"Event"),e.qZA()(),e.TgZ(6,"div",6)(7,"form",7),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw().eventFormSubmit()}),e.TgZ(8,"div",8)(9,"div",9)(10,"div",10)(11,"label"),e._uU(12,"Name"),e.qZA(),e._UZ(13,"input",11,12),e.TgZ(15,"div",13),e._uU(16,"Name is required"),e.qZA()(),e.TgZ(17,"div",10)(18,"label"),e._uU(19,"Description"),e.qZA(),e._UZ(20,"quill-editor")(21,"textarea",14),e.TgZ(22,"div",13),e._uU(23,"Description is required"),e.qZA()(),e.TgZ(24,"div",10)(25,"label"),e._uU(26,"Image URL"),e.qZA(),e.TgZ(27,"div",15)(28,"div",16),e.YNc(29,Q,1,2,"img",17),e.qZA(),e.TgZ(30,"label",18)(31,"input",19),e.NdJ("uploadOutput",function(s){return e.CHM(t),e.oxw().onUploadOutput(s)}),e.qZA(),e.TgZ(32,"div",13),e._uU(33,"Image URL is required"),e.qZA()()(),e.TgZ(34,"div",13),e._uU(35,"Image URL is required"),e.qZA()()(),e.TgZ(36,"div",9)(37,"div",8)(38,"div",20)(39,"div",10)(40,"label"),e._uU(41,"Start date"),e.qZA(),e.TgZ(42,"input",21,22),e.NdJ("click",function(){return e.CHM(t),e.MAs(43).toggle()})("ngModelChange",function(){return e.CHM(t),e.oxw().setEndDate()}),e.qZA(),e.TgZ(44,"div",13),e._uU(45,"Start date is required"),e.qZA()()(),e.TgZ(46,"div",20)(47,"div",10)(48,"label"),e._uU(49,"Change end date"),e.qZA(),e.TgZ(50,"div",23)(51,"input",24),e.NdJ("change",function(s){return e.CHM(t),e.oxw().changeEndDate=s.target.checked}),e.qZA(),e._UZ(52,"label",25),e.qZA()()(),e.TgZ(53,"div",20)(54,"div",10)(55,"label"),e._uU(56,"End date"),e.qZA(),e.TgZ(57,"input",26,27),e.NdJ("click",function(){return e.CHM(t),e.MAs(58).toggle()}),e.qZA(),e.TgZ(59,"div",13),e._uU(60,"End date is required"),e.qZA()()()(),e.TgZ(61,"div",8)(62,"div",20)(63,"div",10)(64,"label"),e._uU(65,"Published"),e.qZA(),e.TgZ(66,"div",23),e._UZ(67,"input",28)(68,"label",29),e.qZA()()()()()(),e.TgZ(69,"div",30)(70,"button",31),e.NdJ("click",function(){return e.CHM(t),e.oxw().cancelEvent()}),e._uU(71,"Cancel"),e.qZA(),e.TgZ(72,"button",32),e._uU(73,"Save"),e.qZA()()()()()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",t.isEdit),e.xp6(1),e.Q6J("ngIf",!t.isEdit),e.xp6(4),e.Q6J("formGroup",t.eventForm),e.xp6(22),e.Q6J("ngIf",t.isEdit),e.xp6(2),e.Q6J("uploadInput",t.uploadInput),e.xp6(11),e.Q6J("readonly",!0),e.xp6(9),e.Q6J("checked",!0===t.changeEndDate),e.xp6(6),e.Q6J("readonly",!0)("disabled",!t.changeEndDate)}}const d=new Date;let T=(()=>{class n{constructor(t,i,s,l,h){this.router=t,this.activatedRoute=i,this.formBuilder=s,this.eventsService=l,this.loader=h,this.changeEndDate=!1,this.LOCAL_PATH=g.N.LOCAL_PATH,this.getId=this.activatedRoute.snapshot.paramMap.get("id"),this.urlSegments=this.activatedRoute.snapshot.url,this.hasEdit(),this.options={concurrency:1,maxUploads:3,maxFileSize:1e6},this.files=[],this.uploadInput=new e.vpe,this.humanizeBytes=Z.kK}ngOnInit(){this.buildForm(),this.setAddEditValidators(),this.loadData(),this.minStartDate={year:d.getFullYear(),month:d.getMonth()+1,day:d.getDate()+1},this.maxStartDate={year:d.getFullYear(),month:d.getMonth()+1,day:d.getDate()+1},this.minEndDate={year:d.getFullYear(),month:d.getMonth()+1,day:d.getDate()+1},this.maxEndDate={year:d.getFullYear(),month:d.getMonth()+1,day:d.getDate()+1},this.isSideMenuShow()}ngAfterViewInit(){setTimeout(()=>this.inputEl.nativeElement.focus(),1e3)}loadData(){this.eventsService.getAll().subscribe(t=>{this.events=t,this.isEdit?(this.event=this.events.find(i=>i.filename==this.getId),this.setData()):this.event={}})}buildForm(){this.eventForm=this.formBuilder.group({name:["",a.kI.required],description:["",a.kI.required],startDate:[null,a.kI.required],endDate:[null],imageName:[null],imageurl:[null],unpublished:[!0],filename:[null]})}setAddEditValidators(){const t=this.eventForm.get("imageName");t.setValidators(this.isEdit?null:[a.kI.required]),t.updateValueAndValidity()}isSideMenuShow(){"true"==localStorage.getItem("isSideMenuShow")&&(document.getElementById("header-nav").style.marginLeft="250px",document.getElementById("side-nav").style.width="250px",document.getElementById("main-content").style.marginLeft="250px")}eventFormSubmit(){this.eventForm.markAllAsTouched(),this.eventForm.valid&&this.saveEvent()}get eventFormControls(){return this.eventForm.controls}hasEdit(){this.urlSegments.forEach(t=>{if("edit"==t.path)return this.isEdit=!0})}setEndDate(){let t=this.eventForm.get("startDate").value;this.eventForm.get("endDate").setValue(t);let i=t.split("/");this.minEndDate={year:parseInt(i[2]),month:parseInt(i[1]),day:parseInt(i[0])},this.maxEndDate={year:parseInt(i[2])+1,month:parseInt(i[1]),day:parseInt(i[0])}}setData(){this.eventForm.get("name").setValue(this.event.name),this.eventForm.get("description").setValue(this.event.description),this.eventForm.get("startDate").setValue(this.event.startDate),this.eventForm.get("endDate").setValue(this.event.endDate),this.eventForm.get("imageurl").setValue(this.event.imageurl),this.eventForm.get("unpublished").setValue(!this.event.unpublished),this.eventForm.get("filename").setValue(this.event.filename),this.eventForm.get("imageName").setValue(""),this.changeEndDate=this.event.startDate!==this.event.endDate}getData(){this.event.name=this.eventForm.get("name").value,this.event.description=this.eventForm.get("description").value,this.event.startDate=this.eventForm.get("startDate").value,this.event.endDate=this.eventForm.get("endDate").value,this.event.imageurl=this.eventForm.get("imageurl").value,this.event.unpublished=!this.eventForm.get("unpublished").value,this.event.filename=this.eventForm.get("filename").value}saveEvent(){this.getData(),this.isEdit?this.eventsService.update(this.event.filename,this.event).subscribe(t=>{console.log("edit-data",t)},t=>{this.router.navigate(["/events"])},()=>{console.log("success"),this.router.navigate(["/events"])}):this.eventsService.add(this.event).subscribe(t=>{console.log("add-data",t)},t=>{this.router.navigate(["/events"])},()=>{console.log("success"),this.router.navigate(["/events"])})}cancelEvent(){this.router.navigate(["/events"])}onUploadOutput(t){switch(t.type){case"allAddedToQueue":this.uploadInput.emit({type:"uploadAll",url:`${g.N.CONTEXT_PATH}/fileupload`,method:"POST"});break;case"addedToQueue":void 0!==t.file&&this.files.push(t.file);break;case"uploading":if(void 0!==t.file){const s=this.files.findIndex(l=>void 0!==t.file&&l.id===t.file.id);this.files[s]=t.file}break;case"removed":this.files=this.files.filter(s=>s!==t.file);break;case"dragOver":this.dragOver=!0;break;case"dragOut":case"drop":this.dragOver=!1;break;case"done":this.event.imageurl="/images/events/"+t.file.name}}cancelUpload(t){this.uploadInput.emit({type:"cancel",id:t})}removeFile(t){this.uploadInput.emit({type:"remove",id:t})}removeAllFiles(){this.uploadInput.emit({type:"removeAll"})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.F0),e.Y36(c.gz),e.Y36(a.qu),e.Y36(p),e.Y36(L.LA))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-events-form"]],viewQuery:function(t,i){if(1&t&&e.Gf(O,5),2&t){let s;e.iGM(s=e.CRH())&&(i.inputEl=s.first)}},decls:2,vars:1,consts:[["id","main-content"],["class","card event",4,"ngIf"],[1,"card","event"],[1,"card-header"],[4,"ngIf"],[1,"name"],[1,"card-body"],["ScrollToInvalidControl","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-lg-6"],[1,"form-control-group"],["type","text","formControlName","name",1,"form-control"],["name",""],[1,"invalid-feedback"],["type","text","formControlName","description",1,"form-control"],[1,"input-group","file-upload"],[1,"input-group-prepend"],["class","thumb",3,"src",4,"ngIf"],[1,"upload-button"],["type","file","ngFileSelect","","formControlName","imageName",1,"form-control","file",3,"uploadInput","uploadOutput"],[1,"col-lg-4"],["type","text","formControlName","startDate","ngbDatepicker","",1,"form-control",3,"readonly","click","ngModelChange"],["startDateDatepicker","ngbDatepicker"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","changeEndDate",1,"custom-control-input","changeEndDate",3,"checked","change"],["for","changeEndDate",1,"custom-control-label"],["type","text","formControlName","endDate","ngbDatepicker","",1,"form-control",3,"readonly","disabled","click"],["endDateDatepicker","ngbDatepicker"],["type","checkbox","formControlName","unpublished","id","unpublished",1,"custom-control-input","unpublished"],["for","unpublished",1,"custom-control-label"],[1,"action-buttons"],[1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary"],[1,"thumb",3,"src"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.YNc(1,B,74,9,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",i.event))},directives:[u.O5,a._Y,a.JL,w,a.sg,a.Fj,a.JJ,a.u,Z.qx,J.J4,a.Wl],encapsulation:2}),n})();var H=r(5167),V=r(7602),G=r(1235);let m=(()=>{class n{constructor(t,i,s,l){this.router=t,this.authenticationService=i,this.userProfileService=s,this.permissionsService=l,this.isLoggedIn=this.authenticationService.isLoggedIn}canActivate(t,i){return!!this.authenticationService.currentUserValue||(this.router.navigate(["/login"],{queryParams:{returnUrl:i.url}}),!1)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(c.F0),e.LFG(H.$),e.LFG(V.i),e.LFG(G.YI))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const P=[{path:"",component:q,canActivate:[m]},{path:"details/:id",component:N,canActivate:[m],data:{permissions:{only:"ADMIN",redirectTo:"login"}}},{path:"add",component:T,canActivate:[m],data:{permissions:{only:"ADMIN",redirectTo:"login"}}},{path:"edit/:id",component:T,canActivate:[m],data:{permissions:{only:"ADMIN",redirectTo:"login"}}}];let R=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[c.Bz.forChild(P)],c.Bz]}),n})(),$=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[p],imports:[[u.ez,R,_.JF,a.u5,a.UX,E.m]]}),n})()}}]);