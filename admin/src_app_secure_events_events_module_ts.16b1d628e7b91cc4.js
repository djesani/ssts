"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([["src_app_secure_events_events_module_ts"],{5459:(Q,T,r)=>{r.r(T),r.d(T,{EventsModule:()=>v});var _=r(6895),A=r(529),s=r(4006),x=r(5980),m=r(8478),e=r(4650),Z=r(2340);const h=`${Z.N.CONTEXT_PATH}/events`;class l{constructor(t){this.http=t}getAll(){return this.http.get(h)}get(t){return this.http.get(`${h}/${t}`)}add(t){return this.http.post(h,t)}update(t,n){return this.http.patch(`${h}/${t}`,n)}delete(t){return this.http.delete(`${h}/${t}`)}}l.\u0275fac=function(t){return new(t||l)(e.LFG(A.eN))},l.\u0275prov=e.Yz7({token:l,factory:l.\u0275fac});var D=r(2216);class g{transform(t,n,o){return o?(t||[]).filter(a=>n.split(",").some(c=>a.hasOwnProperty(c)&&new RegExp(o,"gi").test(a[c]))):t}}g.\u0275fac=function(t){return new(t||g)},g.\u0275pipe=e.Yjl({name:"search",type:g,pure:!0});const F=function(){return["fas","check-circle"]};function y(i,t){1&i&&(e.TgZ(0,"span",25),e._UZ(1,"fa-icon",11),e.qZA()),2&i&&(e.xp6(1),e.Q6J("icon",e.DdM(1,F)))}const M=function(){return["fas","times-circle"]};function U(i,t){1&i&&(e.TgZ(0,"span",26),e._UZ(1,"fa-icon",11),e.qZA()),2&i&&(e.xp6(1),e.Q6J("icon",e.DdM(1,M)))}function q(i,t){if(1&i&&(e.TgZ(0,"div",18)(1,"div",14)(2,"div",19),e._uU(3),e.qZA()(),e.TgZ(4,"div",15),e._UZ(5,"div",20),e.qZA(),e.TgZ(6,"div",16)(7,"div",19),e._uU(8),e.qZA()(),e.TgZ(9,"div",21),e.YNc(10,y,2,2,"span",22),e.YNc(11,U,2,2,"span",23),e.qZA(),e.TgZ(12,"div",16)(13,"button",24),e._uU(14,"Edit"),e.qZA()()()),2&i){const n=t.$implicit;e.xp6(3),e.Oqu(n.name),e.xp6(2),e.Q6J("innerHTML",n.description,e.oJD),e.xp6(3),e.Oqu(n.startDate),e.xp6(2),e.Q6J("ngIf",!n.unpublished),e.xp6(1),e.Q6J("ngIf",n.unpublished),e.xp6(2),e.MGl("routerLink","edit/",n.filename,"")}}const I=function(){return["fas","search"]};function N(i,t){if(1&i){const n=e.EpF();e.TgZ(0,"div",2)(1,"div",3)(2,"header",4)(3,"div",5)(4,"div",6)(5,"button",7),e._uU(6,"Add"),e.qZA()(),e.TgZ(7,"div",8)(8,"div",9)(9,"input",10),e.NdJ("ngModelChange",function(a){e.CHM(n);const c=e.oxw();return e.KtG(c.query=a)}),e.qZA(),e._UZ(10,"fa-icon",11),e.qZA()()()()(),e.TgZ(11,"div",12)(12,"div",13)(13,"div",14),e._uU(14," Name "),e.qZA(),e.TgZ(15,"div",15),e._uU(16," Description "),e.qZA(),e.TgZ(17,"div",16),e._uU(18," Start date "),e.qZA(),e.TgZ(19,"div",16),e._uU(20," Published "),e.qZA(),e._UZ(21,"div",16),e.qZA(),e.YNc(22,q,15,6,"div",17),e.ALo(23,"search"),e.qZA()()}if(2&i){const n=e.oxw();e.xp6(9),e.Q6J("ngModel",n.query),e.xp6(1),e.Q6J("icon",e.DdM(7,I)),e.xp6(12),e.Q6J("ngForOf",e.Dn7(23,3,n.events,"name,description,startDate",n.query))}}class f{constructor(t){this.eventsService=t}ngOnInit(){this.eventsService.getAll().subscribe(t=>{this.events=t})}}f.\u0275fac=function(t){return new(t||f)(e.Y36(l))},f.\u0275cmp=e.Xpm({type:f,selectors:[["app-events-list"]],decls:2,vars:1,consts:[["id","main-content2"],["class","events",4,"ngIf"],[1,"events"],[1,"header-nav"],["id","header-nav"],[1,"row","add-wrapper"],[1,"col-sm-1","btn-add-container"],["routerLink","add",1,"btn","btn-primary","btn-add"],[1,"col-sm-11"],[1,"header-search-wrapper"],["placeholder","search . . .",1,"header-search-input",3,"ngModel","ngModelChange"],[3,"icon"],[1,"events-list"],[1,"row","row-event-header"],[1,"col-2"],[1,"col-7"],[1,"col-1"],["class","row row-event",4,"ngFor","ngForOf"],[1,"row","row-event"],[1,"event-name"],[1,"event-name",3,"innerHTML"],[1,"col-1","read-only","published-status"],["class","published",4,"ngIf"],["class","unpublished",4,"ngIf"],[1,"btn","btn-primary",3,"routerLink"],[1,"published"],[1,"unpublished"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,N,24,8,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.events))},dependencies:[_.sg,_.O5,m.rH,s.Fj,s.JJ,s.On,D.BN,g],styles:["table[_ngcontent-%COMP%] {\n        width: 100%;\n    }\n\n    .mat-table[_ngcontent-%COMP%] {\n        background: transparent;\n    }\n\n    .mat-header-row[_ngcontent-%COMP%] {\n        border-bottom: 2px solid #690f79;\n        padding: 10px 0;\n        color: var(--bs-secondary);\n        font-size: 16px;\n        font-weight: bold;\n    }\n\n    .mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%] {\n        font-size: 16px;\n        color: #5b1e67;\n        padding: 0 10px;\n    }\n\n    .mat-header-cell[_ngcontent-%COMP%] {\n        font-size: 18px;\n    }\n\n    .events-list[_ngcontent-%COMP%] {\n        padding: 80px 0px 0;\n        margin: 0 20px;\n    }\n\n    td.mat-cell[_ngcontent-%COMP%]:first-of-type, td.mat-footer-cell[_ngcontent-%COMP%]:first-of-type {\n        padding-left: 0px;\n    }"]});var E=r(6913),k=r(2953),J=r(8420),C=r(7375);const O=["name"];function S(i,t){1&i&&(e.TgZ(0,"span"),e._uU(1,"Edit "),e.qZA())}function L(i,t){1&i&&(e.TgZ(0,"span"),e._uU(1,"Add "),e.qZA())}function w(i,t){if(1&i){const n=e.EpF();e.TgZ(0,"div",2)(1,"h5",3),e.YNc(2,S,2,0,"span",4),e.YNc(3,L,2,0,"span",4),e.TgZ(4,"span",5),e._uU(5,"Event"),e.qZA()(),e.TgZ(6,"div",6)(7,"form",7),e.NdJ("ngSubmit",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.eventFormSubmit())}),e.TgZ(8,"div",8)(9,"div",9)(10,"div",10)(11,"label"),e._uU(12,"Name"),e.qZA(),e._UZ(13,"input",11),e.TgZ(14,"div",12),e._uU(15,"Name is required"),e.qZA()(),e.TgZ(16,"div",10)(17,"label"),e._uU(18,"Description"),e.qZA(),e._UZ(19,"angular-editor",13),e.TgZ(20,"div",12),e._uU(21,"Description is required"),e.qZA()()(),e.TgZ(22,"div",9)(23,"div",8)(24,"div",14)(25,"div",10)(26,"label"),e._uU(27,"Start date"),e.qZA(),e.TgZ(28,"input",15,16),e.NdJ("click",function(){e.CHM(n);const a=e.MAs(29);return e.KtG(a.toggle())})("ngModelChange",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.setEndDate())}),e.qZA(),e.TgZ(30,"div",12),e._uU(31,"Start date is required"),e.qZA()()(),e.TgZ(32,"div",17)(33,"div",10)(34,"label"),e._uU(35,"Published"),e.qZA(),e.TgZ(36,"div",18),e._UZ(37,"input",19),e.qZA()()(),e.TgZ(38,"div",14)(39,"div",10)(40,"label"),e._uU(41,"Change end date"),e.qZA(),e.TgZ(42,"div",20)(43,"div",18)(44,"input",21),e.NdJ("change",function(a){e.CHM(n);const c=e.oxw();return e.KtG(c.onChangeEndDate(a))}),e.qZA()(),e.TgZ(45,"input",22,23),e.NdJ("click",function(){e.CHM(n);const a=e.MAs(46);return e.KtG(a.toggle())}),e.qZA(),e.TgZ(47,"div",12),e._uU(48,"End date is required"),e.qZA()()()()(),e.TgZ(49,"div",8)(50,"div",24)(51,"label"),e._uU(52,"Image URL"),e.qZA(),e.TgZ(53,"div",25)(54,"div",26),e._UZ(55,"img",27),e.qZA(),e.TgZ(56,"label",28)(57,"input",29),e.NdJ("uploadOutput",function(a){e.CHM(n);const c=e.oxw();return e.KtG(c.onUploadOutput(a))}),e.qZA(),e.TgZ(58,"div",12),e._uU(59,"Image URL is required"),e.qZA()()(),e.TgZ(60,"div",12),e._uU(61,"Image URL is required"),e.qZA()()()()(),e.TgZ(62,"div",30)(63,"button",31),e.NdJ("click",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.cancelEvent())}),e._uU(64,"Cancel"),e.qZA(),e.TgZ(65,"button",32),e._uU(66,"Save"),e.qZA()()()()()}if(2&i){const n=e.oxw();e.xp6(2),e.Q6J("ngIf",n.isEdit),e.xp6(1),e.Q6J("ngIf",!n.isEdit),e.xp6(4),e.Q6J("formGroup",n.eventForm),e.xp6(12),e.Q6J("config",n.editorConfig),e.xp6(9),e.Q6J("readonly",!0),e.xp6(16),e.Q6J("checked",n.changeEndDate),e.xp6(1),e.Q6J("readonly",!0)("disabled",!n.changeEndDate),e.xp6(10),e.hYB("src","",n.LOCAL_PATH,"",n.event.imageurl,"",e.LSH),e.xp6(2),e.Q6J("uploadInput",n.uploadInput)}}const d=new Date;class u{constructor(t,n,o,a){this.router=t,this.activatedRoute=n,this.formBuilder=o,this.eventsService=a,this.changeEndDate=!1,this.LOCAL_PATH=Z.N.LOCAL_PATH,this.editorConfig={editable:!0,spellcheck:!0,height:"auto",minHeight:"0",maxHeight:"auto",width:"auto",minWidth:"0",translate:"yes",enableToolbar:!0,showToolbar:!0,placeholder:"Enter text here...",defaultParagraphSeparator:"",defaultFontName:"",defaultFontSize:"",customClasses:[],uploadWithCredentials:!1,sanitize:!0,toolbarPosition:"top",toolbarHiddenButtons:[["undo","redo","subscript","superscript","indent","outdent","customClasses","unlink","insertImage","insertVideo","insertHorizontalRule","toggleEditorMode"]]},this.getId=this.activatedRoute.snapshot.paramMap.get("id"),this.urlSegments=this.activatedRoute.snapshot.url,this.hasEdit(),this.options={concurrency:1,maxUploads:3,maxFileSize:1e6},this.files=[],this.uploadInput=new e.vpe,this.humanizeBytes=E.kK}ngOnInit(){this.buildForm(),this.setAddEditValidators(),this.loadData(),this.minStartDate={year:d.getFullYear(),month:d.getMonth()+1,day:d.getDate()+1},this.maxStartDate={year:d.getFullYear(),month:d.getMonth()+1,day:d.getDate()+1},this.minEndDate={year:d.getFullYear(),month:d.getMonth()+1,day:d.getDate()+1},this.maxEndDate={year:d.getFullYear(),month:d.getMonth()+1,day:d.getDate()+1}}loadData(){this.eventsService.getAll().subscribe(t=>{this.events=t,this.isEdit?(console.log("this.events",this.events),this.event=this.events.find(n=>n.filename==this.getId),this.setData()):this.event={}})}buildForm(){this.eventForm=this.formBuilder.group({name:["",s.kI.required],description:["",s.kI.required],startDate:[null,s.kI.required],endDate:[null],imageName:[null],imageurl:[null],unpublished:[!0],filename:[null]})}setAddEditValidators(){const t=this.eventForm.get("imageName");t.setValidators(this.isEdit?null:[s.kI.required]),t.updateValueAndValidity()}eventFormSubmit(){this.eventForm.markAllAsTouched(),this.eventForm.valid&&this.saveEvent()}get eventFormControls(){return this.eventForm.controls}hasEdit(){this.urlSegments.forEach(t=>{if("edit"==t.path)return this.isEdit=!0})}setEndDate(){let t=this.eventForm.get("startDate").value;this.eventForm.get("endDate").setValue(t);let n=t.split("/");this.minEndDate={year:parseInt(n[2]),month:parseInt(n[1]),day:parseInt(n[0])},this.maxEndDate={year:parseInt(n[2])+1,month:parseInt(n[1]),day:parseInt(n[0])}}onChangeEndDate(t){this.changeEndDate=t.target.checked}setData(){this.eventForm.get("name").setValue(this.event.name),this.eventForm.get("description").setValue(this.event.description),this.eventForm.get("startDate").setValue(this.event.startDate),this.eventForm.get("endDate").setValue(this.event.endDate),this.eventForm.get("imageurl").setValue(this.event.imageurl),this.eventForm.get("unpublished").setValue(!this.event.unpublished),this.eventForm.get("filename").setValue(this.event.filename),this.eventForm.get("imageName").setValue(""),this.changeEndDate=this.event.startDate!==this.event.endDate}getData(){this.event.name=this.eventForm.get("name").value,this.event.description=this.eventForm.get("description").value,this.event.startDate=this.eventForm.get("startDate").value,this.event.endDate=this.eventForm.get("endDate").value,this.event.unpublished=!this.eventForm.get("unpublished").value,this.event.filename=this.eventForm.get("filename").value}saveEvent(){this.getData(),this.isEdit?this.eventsService.update(this.event.filename,this.event).subscribe(t=>{console.log("edit-data",t)},t=>{this.router.navigate(["events"])},()=>{console.log("success"),this.router.navigate(["events"])}):this.eventsService.add(this.event).subscribe(t=>{console.log("add-data",t)},t=>{this.router.navigate(["events"])},()=>{console.log("success"),this.router.navigate(["events"])})}cancelEvent(){this.router.navigate(["events"])}onUploadOutput(t){switch(t.type){case"allAddedToQueue":this.uploadInput.emit({type:"uploadAll",url:`${Z.N.CONTEXT_PATH}/fileupload`,method:"POST"});break;case"addedToQueue":typeof t.file<"u"&&this.files.push(t.file);break;case"uploading":if(typeof t.file<"u"){const o=this.files.findIndex(a=>typeof t.file<"u"&&a.id===t.file.id);this.files[o]=t.file}break;case"removed":this.files=this.files.filter(o=>o!==t.file);break;case"dragOver":this.dragOver=!0;break;case"dragOut":case"drop":this.dragOver=!1;break;case"done":this.event.imageurl="images/events/"+t.file.name}}cancelUpload(t){this.uploadInput.emit({type:"cancel",id:t})}removeFile(t){this.uploadInput.emit({type:"remove",id:t})}removeAllFiles(){this.uploadInput.emit({type:"removeAll"})}}u.\u0275fac=function(t){return new(t||u)(e.Y36(m.F0),e.Y36(m.gz),e.Y36(s.qu),e.Y36(l))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-events-form"]],viewQuery:function(t,n){if(1&t&&e.Gf(O,5),2&t){let o;e.iGM(o=e.CRH())&&(n.inputEl=o.first)}},decls:2,vars:1,consts:[["id","main-content2"],["class","card event",4,"ngIf"],[1,"card","event"],[1,"card-header"],[4,"ngIf"],[1,"name"],[1,"card-body"],["ScrollToInvalidControl","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-lg-6"],[1,"form-control-group"],["type","text","formControlName","name",1,"form-control"],[1,"invalid-feedback"],["formControlName","description",1,"form-control","description",3,"config"],[1,"col-lg-5"],["type","text","formControlName","startDate","ngbDatepicker","",1,"form-control",3,"readonly","click","ngModelChange"],["startDateDatepicker","ngbDatepicker"],[1,"col-lg-2"],[1,"form-check"],["type","checkbox","formControlName","unpublished","id","unpublished",1,"form-check-input","custom-control-input","unpublished"],[1,"changeEndDateWrapper"],["type","checkbox","id","changeEndDate",1,"form-check-input","custom-control-input","changeEndDate",3,"checked","change"],["type","text","formControlName","endDate","ngbDatepicker","",1,"form-control",3,"readonly","disabled","click"],["endDateDatepicker","ngbDatepicker"],[1,"form-control-group","image-url-fcg"],[1,"input-group","file-upload"],[1,"input-group-prepend"],[1,"thumb",3,"src"],[1,"upload-button"],["type","file","ngFileSelect","","formControlName","imageName",1,"form-control","file",3,"uploadInput","uploadOutput"],[1,"action-buttons"],[1,"btn","btn-default",3,"click"],["type","submit",1,"btn","btn-primary"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,w,67,11,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.event))},dependencies:[_.O5,s._Y,s.Fj,s.Wl,s.JJ,s.JL,s.sg,s.u,k.J4,E.qx,J.s,C.s6],encapsulation:2});var b=r(9390);const H=[{path:"",component:f,canActivate:[b.a],data:{permissions:{only:"ADMIN",redirectTo:"login"}}},{path:"add",component:u,canActivate:[b.a],data:{permissions:{only:"ADMIN",redirectTo:"login"}}},{path:"edit/:id",component:u,canActivate:[b.a],data:{permissions:{only:"ADMIN",redirectTo:"login"}}}];class p{}p.\u0275fac=function(t){return new(t||p)},p.\u0275mod=e.oAB({type:p}),p.\u0275inj=e.cJS({imports:[m.Bz.forChild(H),m.Bz]});var P=r(7155);class v{}v.\u0275fac=function(t){return new(t||v)},v.\u0275mod=e.oAB({type:v}),v.\u0275inj=e.cJS({providers:[l],imports:[_.ez,p,A.JF,s.u5,s.UX,x.m,C.UM,P.p0]})}}]);